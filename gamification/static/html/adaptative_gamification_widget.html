<div class="gamification_block">

	<!-- ID1 :: {self.scope_ids.usage_id}
	ID2 :: {self.scope_ids.def_id} -->
 	<div id="incr-{self.scope_ids.def_id}"></div>
 
    <script>
	fetch("https://agmodule.herokuapp.com/api/g_mechancis/retrieve_adaptative_widget_id?user=user2")
	.then(response => response.json())
    .then(gmJson => (gmJson.gmechanic_id))
    .then(mech_id => ( fetch("https://agmodule.herokuapp.com/api/g_mechanics/" + mech_id + "/?user=user2&dynamic_index=" + "{self.scope_ids.def_id}".replace(/[\s\.\&\:\+\@]/g, "")) //&dynamic_index={self.scope_ids.def_id} 
			        	.then(response => response.json())
			            .then(gmJson => (document.getElementById('incr-{self.scope_ids.def_id}').innerHTML = gmJson.html, 
			            				$(gmJson.html).appendTo(document.body),
			            				console.log("GMechanic successfully loaded")))
			            .catch(error => console.log("Error: " + error))))
    .catch(error => console.log("Error: " + error))
    </script>
</div>
