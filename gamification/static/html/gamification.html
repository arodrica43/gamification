<div class="gamification_block">

	<!-- ID1 :: {self.scope_ids.usage_id}
	ID2 :: {self.scope_ids.def_id} -->
 	<div id="incr-{self.scope_ids.def_id}"></div>
 
    <script>

    	var associations = [
    	 					["Adaptative", "Badge", "Challenge", "DevelopmentTool", "EasterEgg", "Gift", "GiftOpener", "KnowledgeShare", "Level", "Lottery", "Point", "SocialNetwork", "SocialStatus", "Unlockable", "Leaderboard"],
    	 				   	['adaptative_widgets','badge_widgets', 'challenge_widgets', 'development_tool_widgets', 'easter_egg_widgets', 'gift_widgets', 'gift_opener_widgets', 'knowledge_share_widgets', 'level_widgets', 'lottery_widgets', 'point_widgets', 'social_network_widgets', 'social_status_widgets', 'unlockable_widgets', 'leaderboard_widgets'],
    	 				   	['adaptatives','badges', 'challenges', 'development_tools', 'easter_eggs', 'gifts', 'gift_openers', 'knowledge_shares', 'levels', 'lotteries', 'points', 'social_networks', 'social_statuses', 'unlockables', 'leaderboards']
    	 				   ];
        
        if({self.gmechanic_id} == 0)
		    if("{self.gmechanic_type}" == "Adaptative" && "{self.gmechanic_size}" == "Widget")
		    	fetch("https://agmodule.herokuapp.com/api/g_mechancis/retrieve_adaptative_id?user=user2")
				.then(response => response.json())
			    .then(gmJson => (gmJson.gmechanic_id))
			    .then(mech_id => ( fetch("https://agmodule.herokuapp.com/api/g_mechanics/" + mech_id + "/?user=user2&dynamic_index=" + "{self.scope_ids.def_id}".replace(/[\s\.\&\:\+\@]/g, "")) //&dynamic_index={self.scope_ids.def_id} 
						        	.then(response => response.json())
						            .then(gmJson => (document.getElementById('incr-{self.scope_ids.def_id}').innerHTML = gmJson.html, 
						            				$(gmJson.html).appendTo(document.body),
						            				console.log("GMechanic successfully loaded")))
						            .catch(error => console.log("Error: " + error))))
			    .catch(error => console.log("Error: " + error))

     //ADAPTATIVE XBLOCK


    </script>
</div>
